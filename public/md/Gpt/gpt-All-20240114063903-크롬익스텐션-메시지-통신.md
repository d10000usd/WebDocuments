# **<span style="font-size: 35px; font-style: italic;">크롬익스텐션 메시지 통신</span>**

>크롬익스텐션 메시지 통신  
2024년 01월 14일 06시 39분  
SaaS  
#article #code #keyword  
[Github edited](https://github.com/d10000usd/WebDocuments/tree/main/public/md/Gpt "깃허브")
Here’s a brief explanation read more
## Description  

<body class="body-full"><div class="c-custom-card"> <div class="spacing mb-2">  



###  <img src="https://raw.githubusercontent.com/d10000usd/WebDocuments/main/public/icon/Team/40-goal.svg" width="50" height="50" />   

  `bg.ts` 파일에서 `main.tsx` 파일로 메시지를 보내려면, 두 스크립트 간에 통신을 설정해야 합니다. Chrome 확장 프로그램에서는 보통 메시지 패싱을 사용하여 이를 수행합니다. 다음은 간단한 예제입니다:

1. `bg.ts`에서 메시지를 보내는 코드 추가:

```typescript
// bg.ts

import Browser from 'webextension-polyfill';

// ...

function openChatGPTWebpage() {
    Browser.tabs.create({
        url: "https://chat.openai.com/chat",
    });
}

function sendMessagesToContentScript(messages: any[]) {
    // Manifest version check can be added here if necessary

    Browser.tabs.query({ active: true, currentWindow: true }, (tabs) => {
        const activeTab = tabs[0];
        if (activeTab) {
            Browser.tabs.sendMessage(activeTab.id, { messages });
        }
    });
}

Browser.runtime.onInstalled.addListener(async () => openChatGPTWebpage());

if (manifest_version == 2) {
    Browser.browserAction.onClicked.addListener(() => {
        openChatGPTWebpage();
        sendMessagesToContentScript(['Hello from bg.ts']);
    });
} else {
    Browser.action.onClicked.addListener(() => {
        openChatGPTWebpage();
        sendMessagesToContentScript(['Hello from bg.ts']);
    });
}
```

2. `main.tsx`에서 메시지를 수신하는 코드 추가:

```typescript
// main.tsx

function convertChatGPTResponsesToMarkdown() {
  const msgs = document.querySelectorAll("div.whitespace-pre-wrap");
  
  // ...

  // Listen for messages from bg.ts
  browser.runtime.onMessage.addListener((message) => {
      if (message && message.messages) {
          const receivedMessages = message.messages;
          // Do something with receivedMessages
          console.log('Received messages in main.tsx:', receivedMessages);
      }
  });
}
```

이제 `bg.ts`에서 `main.tsx`로 메시지를 보내고, `main.tsx`에서 해당 메시지를 수신하여 처리할 수 있습니다.


  </div></div></div>

  <div style="background-color: grey; height: 15px;"></div>

  